PROMPT 1 OF 7: DATABASE FOUNDATION & CRITICAL FIXES

Context: I'm implementing a complete banking platform rebuild in 7 prompts. This is prompt 1. Read COMPLETE_REBUILD_PLAN.md and DASHBOARD_AUDIT_COMPLETE.md for full context. This is a LIVE production system on Railway - all changes must be backwards compatible.

TASKS:

1. FIX KYC API 500 ERROR
Check backend/src/routes/kycRoutes.js and backend/src/services/kycService.js. Add proper error handling. Test /api/v1/kyc/status endpoint.

2. UPDATE PRISMA SCHEMA (backend/prisma/schema.prisma)

Update Account model - add:
- availableBalance Decimal @default(0)
- pendingBalance Decimal @default(0)
- accountName String?
- cryptoSymbol String?
- cryptoAddress String?
Update accountType enum to include CREDIT_CARD, CRYPTO_WALLET

Create DebitCard model with: id, userId, accountId, cardNumber (encrypted), cardHolderName, cvv (encrypted), expiryDate, cardType, cardBrand, isActive, isFrozen, dailyLimit, createdAt, updatedAt, relations to user/account/transactions

Create CreditCard model with: id, userId, cardNumber, cardHolderName, cvv, expiryDate, creditLimit, availableCredit, currentBalance, apr, minimumPayment, paymentDueDate, statementDate, status (PENDING/APPROVED/ACTIVE/SUSPENDED/CLOSED), approvalStatus, approvedBy, approvedAt, declineReason, isActive, isFrozen, createdAt, updatedAt

Create CreditCardFunding model: id, creditCardId, accountId, amount, status, createdAt

Create CardTransaction model: id, userId, debitCardId?, creditCardId?, amount, merchantName, merchantCategory, description, status, createdAt

Create BankList model: id, bankName, routingNumber (unique), swiftCode, bankType, isActive

Create TransferRequest model: id, userId, fromAccountId, destinationBank, routingNumber, accountNumber, accountName, amount, description, reference (unique), status (PENDING/APPROVED/DECLINED/REVERSED/COMPLETED), adminAction, adminId, adminNotes, processedAt, estimatedCompletion, createdAt, updatedAt

Create Beneficiary model: id, userId, bankName, routingNumber, accountNumber, accountName, nickname, isActive, createdAt

Update User model - add relations: debitCards, creditCards, transferRequests, beneficiaries

3. RUN MIGRATION
npx prisma migrate dev --name prompt1_foundation
npx prisma generate

4. UPDATE ACCOUNT SERVICE (backend/src/services/accountService.js)
Add generateAccountNumber(accountType) function - generates 10 digits, prefix 08 for checking/savings, 03 for crypto
Add calculateBalances(accountId) function - calculates available/pending/current from transactions

5. SEED TOP 100 US BANKS
Create backend/prisma/seeds/banks.js with top 100 US banks including: JPMorgan Chase (021000021), Bank of America (026009593), Wells Fargo (121000248), Citibank (021000089), U.S. Bank (091000022), PNC Bank (043000096), Capital One (065000090), TD Bank (031201360), etc.

6. CLEAN UP PRODUCTION CODE
Remove all console.log debug statements. Add React Router v7 future flags to frontend/src/App.jsx

7. TEST LOCALLY
Start backend and frontend, test KYC endpoint, verify no console errors

8. COMMIT & PUSH
git add .
git commit -m "Prompt 1: Database foundation & critical fixes"
git push origin feature/7-prompt-rebuild

REPORT: After completion, confirm what was implemented, what was fixed, any issues, and if ready for Prompt 2.
